function mapLegend(canvas) {

    var ctx = canvas.getContext("2d");

    var canvasHeight=350;

    if (screen.height<400) {
        canvasHeight = screen.height * 0.6;
        canvas.height = canvasHeight;
    }

    ctx.font="15px Georgia";

    var colorsJSON = <%=(ColorDrop.where layer_id:1).to_json%>;
    var my_gradient=ctx.createLinearGradient(0,canvasHeight-20,0,0);


    var step = 1/colorsJSON.length;
    var counter = 0;
    var stepCounter = 0;

    colorsJSON.forEach(function(a)
    {
        if (a.value==0) {
            my_gradient.addColorStop((step * stepCounter), 'rgba(' + colorsJSON[counter].color + ')');
            ctx.fillText(colorsJSON[0].value,0,canvasHeight-2);
        }
        else {
            my_gradient.addColorStop((step * stepCounter), 'rgba(' + colorsJSON[counter].color + ',5)');
        }
        if (counter == colorsJSON.length/2>>0) {
            ctx.fillText(colorsJSON[counter].value,0,(canvasHeight-canvasHeight/colorsJSON.length*stepCounter)-20);
             console.log(canvasHeight-canvasHeight/colorsJSON.length*stepCounter);
        }
        if (counter == colorsJSON.length-1) {
            ctx.fillText(colorsJSON[counter].value,0,30);
        }

        console.log(a);
        counter++;
        stepCounter++;
    });








    ctx.fillStyle=my_gradient;
    ctx.fillRect(20,20,100,canvasHeight-20);
}